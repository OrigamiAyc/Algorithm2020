# 算法第八次作业

<p align=right>PB18000227 艾语晨 </p>

## 1 (22-3)

### a

#### 有欧拉回路 $\Rightarrow$ in-degree(v)=out-degree(v)

因为图G有一条欧拉回路，则不妨设此回路上依次经过结点序列为：$v_{x_1},\cdots,v_{x_n}=v_{x_1}$。那么对于每一个节点 $v_{x_i}$，在这个回路上都会有一条出边和一条入边，故对于每一个节点v，有 in-degree(v)=out-degree(v)

#### in-degree(v)=out-degree(v) $\Rightarrow$ 有欧拉回路

因为对于连通图G中的每个顶点，其入度等于出度，那么它一定不是一个有向无环图，故图G中必有环$C_1$。考虑$G_1=G-C_1$，若$G_1$没有边，则$G=C_1$。否则，$G_1$中存在一个连通片$G_1'$，其中的每个顶点的入度都等于出度。与上面的证明同理可以得到$G_2$和$G_2'$。以此类推最终在有限次之后必得到无边图$G_n$。所以图$G$是无公共边的圈之并。将这些圈连起来就得到了欧拉回路

### b

从任意一条边开始，任意选择下一条邻边，但是访问边不能重复。由上一问可知，当此图为欧拉图时，所有所边都会在一个闭环上，故在最多经过O(E)当时间，即将所有边都访问一遍之后，会找出来这个欧拉回路

## 2 (24-3)

### a

对所有边权$c_i$取$-\lg(c_i)$作为新的不同货币之间的汇率。这时只需要应用Bellman Ford算法找到一个边权之和为负数的回路即可

### b

如第一问一样对边权做取负对数处理，然后在最后再次relax记录，记录v.d减小v，记为集合s，在s中任选一点，贪心地选择与s中点 构成的边，最终会得到一个环即为所求

由a知，前半部分时间复杂度为O(VE)，后半部分时间复杂度为O(V+E) 时间复杂度为O(VE)

## 3 (25.3-5)

在重新赋值权重的过程中，回路的总权重是不变的，如下：对于一个起点和终点相同的路径（圈）c，有：
$$
\hat w(c)=w(c)+h(v_0)-h(v_k)=w(c)=0
$$
这说明对于一个权重为0的圈，在重新赋值权重之后，它的总权重依然为0。但由于这时已经没有负权重的边，只能有所有边的权重都为0

## 4 (26-4)

### a

若原来有$f (u, v) < c(u, v)$，则对 $(u, v) ∈ E$ 的容量增加一个单位之后最大流不会改变.
若原来有 $f (u, v) = c(u, v)$，则对 $(u, v) ∈ E$ 的容量增加一个单位之后最大流有可能会增加 1。此时只需要迭代一个 2F 算法, 从源顶点通过 BFS 找到当前残存容量图中的一个增广路径, 然后对当前流进行更新即可。一次 BFS 的复杂度为 O(V +E), 满足要求.

### b

如果$f(u, v) < c(u,v)$，那么没有改变。若$f(u,v)=c(u,v)$，利用BFS找到一条含有(u,v)的路径并且每条边的流减一，选择总流量也减一。然后利用FF算法更新。总时间复杂度为O(E+V)

